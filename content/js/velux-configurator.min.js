jQuery.noConflict();(function(b,a,c){c(a).ready(function(){if(navigator.userAgent.match(/MSIE 7/gi)||navigator.userAgent.match(/MSIE 8/gi)||navigator.userAgent.match(/MSIE 9/gi)){b.console={log:function(n){}}}var f=new Date();var e={dom:{base:c("#mmc__Configurator"),options:c("#mmc__Options"),title:c("#mmc__Options .mmc__titleBar"),selection:c("#mmc__Selection"),step:c("#mmc__Options .mmc__configStep"),activeStep:function(){return e.dom.options.find(".mmc__configStep.mmc__active")},windows:c("#mmc__Options .mmc__configStep.mmc__window"),category:c("#mmc__Options .mmc__configStep.mmc__category"),insect:c("#mmc__Options .mmc__configStep.mmc__insectnet"),operation:c("#mmc__Options .mmc__configStep.mmc__operation"),outersurface:c("#mmc__Options .mmc__configStep.mmc__outersurface"),colour:c("#mmc__Options .mmc__configStep.mmc__colour"),finishtype:c("#mmc__Options .mmc__configStep.mmc__finishtype"),variant:c("#mmc__Options .mmc__configStep.mmc__variant"),complete:c("#mmc__Options .mmc__configStep.mmc__complete"),edit:c(".mmc__productRow span.mmc__edit a"),option:function(n,q,r){var o=(n)?(q)?".mmc__option."+q+"."+n+"."+r:".mmc__option."+n+"."+r:"",p=e.dom.options.find(o);return p},inactive:c(".mmc__option.mmc__inactive"),sliding:false,updating:false,insectSelect:c("#mmc__Options .mmc__insectNetTypes label, #mmc__Options .mmc__insectNetTypes button"),blocks:{updating:c("#mmc__Configurator #mmc__Blocks .mmc__updatingOverlay"),usermessage:c("#mmc__Configurator #mmc__Blocks .mmc__userMessage"),tooltip:c("#mmc__Configurator #mmc__Blocks .mmc__tooltip"),infotip:c("#mmc__Configurator #mmc__Blocks .mmc__infotip"),windowtypesize:c("#mmc__Configurator #mmc__Blocks .mmc__windowTypeSize"),mailerPopup:c("#mmc__Configurator #mmc__Blocks .mmc__mailerPopup")},tooltip:"",infotip:null,message:{base:function(){return e.dom.activeStep().find(".mmc__userMessage")},title:function(){return e.dom.message.base().find(".mmc__userMessageTitle")},text:function(){return e.dom.message.base().find(".mmc__userMessageText")},icon:function(){return e.dom.message.base().find(".mmc__userMessageIcon")},close:function(){return e.dom.message.base().find(".mmc__userMessageClose")}}},trigger:{target:"",type:""},request:{href:generalSettings.environment+"?option=com_configurator",did:function(){return e.settings.did},cid:function(){return e.settings.cid},lang:function(){return e.settings.language},format:"json",combi:function(){return(e.vm.controls.showCombination()==true)?true:false},task:function(){var o=e.vm.config.product1,n;if(e.trigger.type=="codeCheck"){n="mmc.validateProductFit"}else{if(e.trigger.type=="sendmail"){n="mmc.sendConfiguratorEmail"}else{n="mmc.Configure"}}return n},data:{1:{windowtype:function(){return e.vm.config.product1.windowtype()},windowsize:function(){return(e.trigger.type=="windowtype")?"":e.vm.config.product1.windowsize()},category:function(){return(e.isBasket())?encodeURI(e.vm.config.product1.categoryText()):(!e.vm.config.product1.windowtype()||!e.vm.config.product1.windowsize())?"":(e.vm.controls.showCombination())?e.vm.config.product1.category()+e.vm.config.product1.category().match(/[A-Z][a-z]+/g)[0]:e.vm.config.product1.category()},operation:function(){return(e.isBasket())?encodeURI(e.vm.config.product1.operationText()):e.vm.config.product1.operation()},finishtype:function(){return(e.isBasket())?encodeURI(e.vm.config.product1.finishtypeText()):e.vm.config.product1.finishtype()},colour:function(){return(e.isBasket())?encodeURI(e.vm.config.product1.colourText()):e.vm.config.product1.colour()},outersurface:function(){return(e.isBasket())?encodeURI(e.vm.config.product1.outersurfaceText()):e.vm.config.product1.outersurface()},openingwidth:function(){return(e.isBasket())?encodeURI(e.vm.config.product1.insectWidthText()):e.vm.config.product1.insectWidth()},openingheight:function(){return(e.isBasket())?encodeURI(e.vm.config.product1.insectHeightText()):e.vm.config.product1.insectHeight()},productid:function(){if(e.isBasket()){return e.vm.config.product1.serviceProductID()}},categorynodeid:function(){if(e.isBasket()&&e.vm.controls.showCombination()){return e.vm.config.product1.category()}},productprice:function(){if(e.isBasket()){return e.vm.config.product1.productPrice()}},configuratorType:function(){if(!e.isBasket()){return e.vm.config.product1.configureType()}}},2:{windowtype:function(){return e.vm.config.product2.windowtype()},windowsize:function(){return(e.trigger.type=="windowtype")?"":e.vm.config.product2.windowsize()},category:function(){return(e.isBasket())?encodeURI(e.vm.config.product2.categoryText()):(!e.vm.config.product2.windowtype()||!e.vm.config.product2.windowsize())?"":(e.vm.controls.showCombination())?e.vm.config.product2.category()+e.vm.config.product2.category().match(/[A-Z][a-z]+/g)[1]:e.vm.config.product2.category()},operation:function(){return(e.isBasket())?encodeURI(e.vm.config.product2.operationText()):e.vm.config.product2.operation()},finishtype:function(){return(e.isBasket())?encodeURI(e.vm.config.product2.finishtypeText()):e.vm.config.product2.finishtype()},colour:function(){return(e.isBasket())?encodeURI(e.vm.config.product2.colourText()):e.vm.config.product2.colour()},outersurface:function(){return(e.isBasket())?encodeURI(e.vm.config.product2.outersurfaceText()):e.vm.config.product2.outersurface()},openingwidth:function(){return(e.isBasket())?encodeURI(e.vm.config.product1.insectWidthText()):e.vm.config.product2.insectWidth()},openingheight:function(){return(e.isBasket())?encodeURI(e.vm.config.product2.insectHeightText()):e.vm.config.product2.insectHeight()},productid:function(){if(e.isBasket()){return e.vm.config.product2.serviceProductID()}},categorynodeid:function(){if(e.isBasket()&&e.vm.controls.showCombination()){return e.vm.config.product2.category()}},productprice:function(){if(e.isBasket()){return e.vm.config.product2.productPrice()}},configuratorType:function(){if(!e.isBasket()){return e.vm.config.product2.configureType()}}},3:{windowtype:function(){return e.vm.config.product1.windowtype()},windowsize:function(){return(e.trigger.type=="windowtype")?"":e.vm.config.product1.windowsize()},productid:function(){if(e.isBasket()){return e.vm.addon.serviceProductID()}},productprice:function(){if(e.isBasket()){return e.vm.addon.productPrice()}},description:function(){if(e.isBasket()){return e.vm.addon.Name()}}}}},isBasket:function(){if(e.trigger.type=="gotobasket"){return true}else{return false}},formatPrice:function(r){var s,o,n;s=r.split(".")[0],o=r.split(".")[1],n=[];for(var q=s.length,p=0;q>p;q-=3){n.unshift(s.substring(q,q-3))}if(o){if(o.length>2){o=o.slice(0,2)}else{if(o.length==1){o=o+"0"}}o=(e.settings.decimalNum==0)?"":e.settings.sepD+o.slice(0,o.length-(2-e.settings.decimalNum))}return n.join(e.settings.sepT)+'<span class="mmc__decimals">'+o+"</span>"},setActiveStep:function(){var n=c(e.dom.options.find(".mmc__configStep.mmc__required:not(.mmc__filled)")[0]);n.find(".mmc__content").show();n.addClass("mmc__active");if(n.hasClass("mmc__complete")){e.dom.selection.find(".mmc__product").hide()}e.dom.selection.css("marginTop",e.measure.stepHeight*e.dom.activeStep().index(".mmc__required"))},buildRequest:function(){var p=e.request,o=[],n=[];c.each(p,function(q,r){if(q=="href"){return}if(typeof r!="object"){if(r&&typeof r!="function"){o.push(q+"="+r)}else{if(r&&typeof r=="function"){o.push(q+"="+r())}}}else{if(e.trigger.type=="codeCheck"){n.push('"windowtype":"'+e.vm.config.product1.windowtype()+'"');n.push('"windowsize":"'+e.vm.config.product1.windowsize()+'"');if(e.trigger.target.hasClass("mmc__variant")){n.push('"productid":"'+e.settings.rules.variant.ID+'"');n.push('"variantcode":"'+e.vm.config.product1.variantcode()+'"')}else{n.push('"productid":"'+e.settings.rules.production.ID+'"');n.push('"productioncode":"'+e.vm.config.product1.productioncode()+'"')}}else{c.each(r,function(t,u){if(e.vm.controls.showProduct2()){if((t==1&&!e.vm.controls.buyProduct1())||(t==2&&!e.vm.controls.buyProduct2())||(t==3&&!e.vm.controls.buyProductAddon())){return}}if(e.isBasket()){if((t==2&&!e.vm.controls.showProduct2()&&!e.vm.controls.showCombination())||(t==3&&!e.vm.controls.showAddon())){return}}else{if((t==2&&!e.vm.controls.showProduct2()&&!e.vm.controls.showCombination())||(t==2&&e.vm.config.product1.windowtype()=="GDL")||(t==3&&!e.vm.controls.showAddon())){return}}var s=[],v=(e.settings.basketType=="veluxshop")?"product"+t:t;c.each(u,function(x,w){if(w()&&w()!="undefined"){s.push('"'+x+'":"'+w()+'"')}});n.push('"'+v+'":{'+s.join(",")+"}")})}}});return(e.isBasket())?"{"+n.join(",")+"}":p.href+"&"+o.join("&")+"&data={"+n.join(",")+"}"},options:["windowtype","windowsize","category","operation","finishtype","colour","outersurface","insectWidth","insectHeight"],measure:{stepHeight:c("#mmc__Options .mmc__titleBar").height()+parseInt(c("#mmc__Options .mmc__configStep").css("marginBottom"))},settings:{doNotHide:false,defaultImg:"product1",sepT:".",sepD:",",decimalNum:2,closeText:c("#mmc__Settings .mmc__setCloseText").text(),noResultsText:c("#mmc__Settings .mmc__setNoResultsText").text(),insect:{widthPreText:c("#mmc__Settings .mmc__setInsectNetWidthPretext").text()+" ",heightPreText:c("#mmc__Settings .mmc__setInsectNetHeightPretext").text()+" ",postText:" "+c("#mmc__Settings .mmc__setInsectNetMeasurementText").text(),widths:{BZ:c("#mmc__Settings .mmc__setInsectNetWidthBZ").text(),CZ:c("#mmc__Settings .mmc__setInsectNetWidthCZ").text(),FZ:c("#mmc__Settings .mmc__setInsectNetWidthFZ").text(),MZ:c("#mmc__Settings .mmc__setInsectNetWidthMZ").text(),PZ:c("#mmc__Settings .mmc__setInsectNetWidthPZ").text(),SZ:c("#mmc__Settings .mmc__setInsectNetWidthSZ").text(),UZ:c("#mmc__Settings .mmc__setInsectNetWidthUZ").text()},height:"",measurement:(c("#mmc__Settings .mmc__setInsectNetMeasurement").text())?parseInt(c("#mmc__Settings .mmc__setInsectNetMeasurement").text()):1,sizes:{},type:"double",shape:function(){return e.dom.insect.find(".mmc__option.mmc__active").attr("id").replace("mmc__","")}},selectTypeText:c("#mmc__Settings .mmc__setSelectTypeText").text(),selectSizeText:c("#mmc__Settings .mmc__setSelectSizeText").text(),flatroofSizes:["CVP","CFP"],country:"IT",tooltip:{},infotip:{},infotipMessage:c("#mmc__Settings .mmc__setDefaultTooltipMessage").text(),showInactive:false,rules:{list:{},timeout:null,product:{},variant:{MatchFoundFalse:null,MatchFoundTrue:null,ID:null},production:{MatchFoundFalse:null,MatchFoundTrue:null,ID:null},variantUnknown:"",productionUnknown:""},ill:{loc:function(){if(e.settings.illustrationsDirectory){return e.settings.illustrationsDirectory}else{return e.settings.directory+"content/images/configurator/illustrations/"}}},categoriesOrder:c("#mmc__Settings .mmc__categoriesOrder").text().split(",").slice(0,-1)},vm:{},init:function(){e.settings.onBeforeInit();var o=e.vm.config.product1,p=b.location.search;c(e.settings.target).find("#mmc__Configurator").removeAttr("style");function n(){var r=e.dom.base.width(),q=r-e.dom.options.width()-parseInt(e.dom.selection.css("paddingLeft"))-parseInt(e.dom.selection.css("paddingRight"));if(r<914){e.dom.selection.addClass("mmc__hidden").removeClass("mmc__thin")}else{if(r>=914&&r<984){e.dom.selection.removeClass("mmc__hidden").addClass("mmc__thin").width(q);e.dom.selection.find(".mmc__content").width(q)}else{if(r>=984){e.dom.selection.removeAttr("class").width("");e.dom.selection.find(".mmc__content").removeAttr("style")}}}}n();c(b).resize(n);e.dom.options.find("select").chosen({width:"100%",no_results_text:e.settings.noResultsText});i.setStepIndex();e.dom.windows.find(".mmc__select.mmc__type input:first, .mmc__select.mmc__size input:first").attr("autocomplete","off");e.dom.windows.find(".mmc__select.mmc__type input:first").attr("tabindex","1");e.dom.windows.find(".mmc__select.mmc__size input:first").attr("tabindex","2");e.dom.windows.find(".mmc__buttonBar .mmc__button a").attr("tabindex","3");e.dom.windows.find(".mmc__select.type input:first").val("");e.dom.windows.find(".mmc__select.size input:first").val("");p=p.slice(1,p.length).split("&");c.each(p,function(q,u){var r=u.split("=")[0],t=u.split("=")[1];r=(r=="blindtype")?"category":r;if(r=="windowtype"||r=="windowsize"){e.vm.data.product1[r].push({val:t,name:t})}try{o[r](t)}catch(s){}});e.settings.onAfterInit();e.update();e.setActiveStep()},update:function(){var o=e.vm.config.product1,q,n,p=new Date();e.settings.rules.product={};e.dom.activeStep().append(e.dom.blocks.updating.clone());e.dom.activeStep().addClass("mmc__updating");if(e.isBasket()){return false}if(e.vm.controls.showCombination()){e.vm.config.product2.category(o.category())}else{c.each(e.options,function(r,s){if(s=="insectHeight"){return}e.vm.config.product2[s](e.vm.config.product1[s]())})}e.settings.onBeforeUpdate();c.ajax({dataType:"jsonp",jsonpCallback:"jsonCallback",type:"GET",url:e.buildRequest(),beforeSend:function(r){r.setRequestHeader("Access-Control-Allow-Origin","*")},success:function(r){t4=new Date();var s=r;c.each(s,function(t,u){c.each(u,function(v,w){c.each(w,function(x,y){e.process[v]("product"+(t+1),y)})})});e.dom.base.removeClass("mmc__loading");if(e.settings.loadingTitle){c(e.settings.target).find("#mmc__LoadingConfigurator").remove()}if(e.settings.doNotHide==false){e.dom.activeStep().removeClass("mmc__updating");e.dom.activeStep().find(".mmc__updatingOverlay").remove()}e.settings.onAfterUpdate();e.settings.doNotHide=false;i.updateIllustration(o)},error:function(r){}});if(e.settings.insect.height){e.dom.insect.find('select[name="insectHeight"]').val(e.settings.insect.height);e.settings.insect.height=null;e.dom.insect.find("select").trigger("chosen:updated")}i.checkFilledSteps(o);i.setStepIndex();q=e.dom.options.find(".mmc__configStep").length-1;n=e.dom.options.find(".mmc__configStep.mmc__filled").length;if(q==n){o.showPrice(true)}else{o.showPrice(false)}e.dom.selection.css("marginTop",e.measure.stepHeight*e.dom.activeStep().index(".mmc__required"))},process:{WindowTypes:function(p,o){var q=e.vm.data,n=e.vm.config;if((e.vm.config.product1.windowtype()!=""&&q.product1.windowtype().length>2)&&e.trigger.type){return}if(!o.length){o=[o]}c.each(q,function(s,t){var r=0;c.each(o,function(u,v){t.windowtype()[++r]={val:v.WindowID,name:v.WindowID}});t.windowtype.valueHasMutated()});if(n.product1.windowtype()!=""){e.dom.windows.find('select#windowtype option[value="'+n.product1.windowtype()+'"]').attr("selected","selected")}i.selectWindowInput()},WindowSizes:function(p,o){var q=e.vm.data,n=e.vm.config;if((e.vm.config.product1.windowsize()!=""&&q.product1.windowsize().length>2)&&e.trigger.type){return}if(!o.length){o=[o]}c.each(q,function(s,t){var r=0;c.each(o,function(u,v){t.windowsize()[++r]={val:v.SizeID,name:v.SizeID}});t.windowsize.valueHasMutated()});if(n.product1.windowsize()!=""){e.dom.windows.find('select#windowsize option[value="'+n.product1.windowsize()+'"]').attr("selected","selected")}i.selectWindowInput()},ValidatedCategory:function(p,o){var r=e.vm.data,n=e.vm.config,q=e.dom.option(n[p].category(),"mmc__category","mmc__active").data("parent");c.each(o,function(s,t){c.each(t.ChildCategories,function(v,u){c.each(u,function(w,y){try{if(y.CategoryName==n[p].category()){if(y.MatchFound==false&&y.CategoryName!="InsectNet"){i.resetSteps();i.checkFilledSteps(n[p])}}}catch(x){}})})});if((e.vm.config[p].category()!=""&&e.vm.data[p].category().length>0)&&e.trigger.type){return}c.each(o,function(s,t){if(c.inArray(t.CategoryName,["BLINDS","FLATROOF","COMBINATION"])!=-1){c.each(t.ChildCategories,function(v,u){c.each(r,function(x,y){var w=0;u=(u.length)?u:[u];c.each(u,function(z,A){if((c.inArray(e.vm.config.product1.windowtype(),e.settings.flatroofSizes)==-1&&!A.CategoryName.match(/flatroof/gi))||(c.inArray(e.vm.config.product1.windowtype(),e.settings.flatroofSizes)!=-1&&A.CategoryName.match(/flatroof/gi))){if(A.MatchFound||(!A.MatchFound&&e.settings.showInactive)||A.CategoryName=="InsectNet"){y.category.push({val:A.CategoryName,name:A.Name,desc:A.Description,parent:t.CategoryName,inactive:(A.MatchFound||A.CategoryName=="InsectNet")?"":"inactive",order:e.settings.categoriesOrder.indexOf(A.CategoryName)})}}});if(e.settings.categoriesOrder){y.category.sort(function(z,A){return z.order-A.order})}y.category.valueHasMutated()})})}});i.selectWindowInput()},HeightWidth:function(p,o){var q=e.vm.data,n=0;if((e.vm.config.product1.operation()!=""||e.trigger.type!="category")&&e.trigger.type){}c.each(o,function(r,s){if(!e.settings.insect.sizes[s.Width]){e.settings.insect.sizes[s.Width]={};e.settings.insect.sizes[s.Width][s.Height]=s.Height}else{e.settings.insect.sizes[s.Width][s.Height]=s.Height}});c.each(e.settings.insect.sizes,function(r,s){q.product1.insectWidth()[n++]={val:r,name:e.settings.insect.widthPreText+(e.settings.insect.widths[r]/e.settings.insect.measurement)+e.settings.insect.postText}});q.product1.insectWidth.valueHasMutated();q.product1.insectWidth.unshift({val:"",name:""});e.dom.insect.find(".mmc__height select, .mmc__height2 select").attr("disabled","disabled");e.dom.insect.find("select").trigger("chosen:updated")},Operations:function(p,o){var r=e.vm.data,n=0,q;if((e.vm.config[p].operation()!=""||e.vm.data[p].operation().length>0)&&e.trigger.type){return}if(!o.length){o=[o]}c.each(r,function(t,u){var s=0;c.each(o,function(v,w){if(w.IsValid||(!w.IsValid&&e.settings.showInactive)){if(e.vm.controls.showCombination()){r[p].operation()[s++]={val:w.OperationID,name:w.Name,desc:w.Description,inactive:(w.IsValid)?"":"inactive"}}else{u.operation()[s++]={val:w.OperationID,name:w.Name,desc:w.Description,inactive:(w.IsValid)?"":"inactive"}}}});u.operation.valueHasMutated()});c.each(o,function(s,t){if(t.IsValid){n++;q=t.OperationID}});if(n==1){e.vm.config[p].operation(q);i.checkFilledSteps(e.vm.config[p])}},Finishes:function(o,n){},FinishTypes:function(p,o){var r=e.vm.data,n=0,q;if(e.vm.config[p].category()!="AddOnPleated"&&e.trigger.type){return}if(!o.length){o=[o]}c.each(r,function(t,u){var s=0;c.each(o,function(v,w){if(w.IsValid||(!w.IsValid&&e.settings.showInactive)){u.finishtype()[s++]={val:w.FinishTypeID,name:w.FinishTypeName,desc:w.FinishTypeDescription,inactive:(w.IsValid)?"":"inactive"}}});u.finishtype.valueHasMutated()});c.each(o,function(s,t){if(t.IsValid){n++;q=t.FinishTypeID}});if(n==1){e.vm.config[p].finishtype(q);i.checkFilledSteps(e.vm.config[p])}},OuterSurfaces:function(p,o){var r=e.vm.data,n=0,q;if((e.vm.config[p].outersurface()!=""||e.vm.data[p].outersurface().length>0)&&e.trigger.type){return}if(!o.length){o=[o]}c.each(r,function(t,u){var s=0;c.each(o,function(v,w){if(w.IsValid||(!w.IsValid&&e.settings.showInactive)){u.outersurface()[s++]={val:w.OuterSurfaceID,name:w.Name,desc:w.Description,inactive:(w.IsValid)?"":"inactive"}}});u.outersurface.valueHasMutated()});c.each(o,function(s,t){if(t.IsValid){n++;q=t.OuterSurfaceID}});if(n==1){e.vm.config[p].outersurface(q);i.checkFilledSteps(e.vm.config[p])}if(e.dom.base.find(".mmc__configStep.mmc__required.mmc__filled:not(.mmc__complete)").length==e.dom.base.find(".mmc__configStep.mmc__required:not(.mmc__complete)").length){e.update()}},Rules:function(o,n){var p=e.vm.data;if(e.settings.rules.timeout!=null){clearTimeout(e.settings.rules.timeout)}if(n.RuleNo=="103"&&n.Family==null){n.RuleNo="507"}if(!e.settings.rules.list[n.RuleNo]){c.each(e.settings.rules.product,function(q,r){if(e.vm.config.product1.category()!="InsectNet"){if(r.RuleNo.match(n.RuleNo)||((r.AskForProductCode||r.AskForTypeSignVariant)&&!r.RuleNo)||n.RuleNo=="507"){n.Product=r}}});e.settings.rules.list[n.RuleNo]=n}e.settings.rules.timeout=setTimeout(function(){l.process(e.settings.rules.list);e.settings.rules.timeout=null},1)},Colors:function(p,o){var r=e.vm.data,n=0,q;if((e.vm.config[p].colour()!=""||e.vm.data[p].colour().length>0)&&e.trigger.type){return}if(!o.length){o=[o]}c.each(r,function(t,u){var s=0,v="";c.each(o,function(w,x){if(x.IsValid||(!x.IsValid&&e.settings.showInactive)){if(e.vm.controls.showCombination()){v=(x.ColorID>4609&&x.ColorID<4622)?"BlackoutDisney":e.vm.config[p].category().match(/[A-Z][a-z]+/g)[p.charAt(p.length-1)-1];r[p].colour()[s++]={cat:v,val:x.ColorID,name:x.ColorID,desc:x.ColorDescription,inactive:(x.IsValid)?"":"inactive"}}else{v=(x.ColorID>4609&&x.ColorID<4622)?"BlackoutDisney":e.vm.config.product1.category();u.colour()[s++]={cat:v,val:x.ColorID,name:x.ColorID,desc:x.Name,inactive:(x.IsValid)?"":"inactive"}}}});u.colour.valueHasMutated()});c.each(o,function(s,t){if(t.IsValid){n++;q=t.ColorID}});if(n==1){e.vm.config[p].colour(q);i.checkFilledSteps(e.vm.config[p])}if(e.dom.base.find(".mmc__configStep.mmc__required.mmc__filled:not(.mmc__complete)").length==e.dom.base.find(".mmc__configStep.mmc__required:not(.mmc__complete)").length&&!e.dom.base.hasClass("mmc__loading")){e.update()}},AvailableProducts:function(o,n){var p=e.vm.config;i.clearCompleteStep();if(n.length){e.vm.controls.showProduct2(true)}if(!n.length){n=[n]}c.each(n,function(q,u){var t=(o=="product2")?o:"product"+(q+1),s=(!u.Price)?u.PriceWithVAT:(u.Price.HasDiscount)?u.Price.ProductPriceDiscounted.PriceWithVAT:u.Price.ProductPrice.PriceWithVAT,r=e.settings["percentDiscount"+p[t].category()];if(r===undefined){r=e.settings.percentDiscount}if(r!=null){s=(parseFloat(s)*((100-r)/100)).toFixed(2)}p[t].productPrice(s);p[t].productID(u.VCE);p[t].serviceProductID(u.ProductID);e.settings.rules.product[t]=(p[o].category()=="Shutters")?u.RollerShutter:(p[o].category()=="InsectNet")?u.InsectNet:u.Blind;if(e.vm.controls.showProduct2()==true){if(e.settings.rules.product[t].AskForTypeSignVariant==true){e.settings.rules.variant.ID=u.ProductID}else{if(e.settings.rules.product[t].AskForProductCode==true){e.settings.rules.production.ID=u.ProductID}}}else{e.settings.rules.variant.ID=u.ProductID;e.settings.rules.production.ID=u.ProductID}})}},change:{windowtype:function(){var o=e.vm.data,n=e.vm.config;e.vm.controls.showProduct2(false);e.vm.controls.showCombination(false);c.each(o,function(p,q){q.windowsize.splice(1,o.product1.windowsize().length-1)});c.each(n,function(p,q){q.windowsize("")});e.settings.onSelectWindowType(n.product1.windowtype());if(n.product1.windowtype()==null){return false}},windowsize:function(){var o=e.vm.data,n=e.vm.config;e.vm.controls.showProduct2(false);e.vm.controls.showCombination(false);c.each(o,function(p,q){q.category.removeAll()});if(n.product1.windowsize()){e.settings.onSelectWindowSize(n.product1.windowsize())}if(n.product1.windowsize()==null){return false}},category:function(){var p=e.vm.data,n=e.vm.config,o=e.trigger.target.closest(".mmc__option").data("parent");e.vm.controls.showProduct2(false);if(o=="COMBINATION"){e.vm.controls.showCombination(true)}else{e.vm.controls.showCombination(false)}e.settings.onSelectCategory(n.product1.category());i.resetSteps()},operation:function(){var o=e.vm.data,n=e.vm.config;e.settings.onSelectOperation(n.product1.operation());i.resetSteps()},outersurface:function(){var o=e.vm.data,n=e.vm.config;e.settings.onSelectOuterSurface(n.product1.outersurface());i.resetSteps()},colour:function(){var o=e.vm.data,n=e.vm.config;e.settings.onSelectColour(n.product1.colour());i.resetSteps()},finishtype:function(){},insectWidth:function(){var s=e.vm.data,p=e.vm.config,o=e.settings.insect.sizes[p.product1.insectWidth()],r=[];c.each(o,function(t,u){r.push(u)});if(e.settings.insect.type=="double"&&e.settings.insect.shape()=="straight"){r=r.join(",");if(r.match(/1600/gi)&&r.match(/2000/gi)&&r.match(/2400/gi)){r=[1600,2000,2400,3200,3600,4000,4400,4800]}else{if(r.match(/1600/gi)&&r.match(/2000/gi)){r=[1600,2000,3200,3600,4000]}else{if(r.match(/1600/gi)&&r.match(/2400/gi)){r=[1600,2400,3200,4000,4800]}else{if(r.match(/2000/gi)&&r.match(/2400/gi)){r=[2000,2400,4000,4400,4800]}else{if(r.match(/1600/gi)){r=[1600,3200]}else{if(r.match(/2000/gi)){r=[2000,4000]}else{if(r.match(/2400/gi)){r=[2400,4800]}}}}}}}}if(e.settings.insect.shape()=="straight"&&e.vm.controls.showProduct2()==true){e.vm.controls.showProduct2(false)}for(var q=1,n=2;q<=n;q++){s["product"+q].insectHeight.splice(1,s["product"+q].insectHeight().length-1);c.each(r,function(t,u){s["product"+q].insectHeight.push({val:u,name:e.settings.insect.heightPreText+(u/e.settings.insect.measurement)+e.settings.insect.postText})});s["product"+q].insectHeight.unshift({val:"",name:""})}p.product1.insectHeight("");p.product2.insectHeight("");e.dom.insect.find("select").removeAttr("disabled").trigger("chosen:updated");return false},insectHeight:function(){var o=e.vm.data,n=e.vm.config;e.settings.insect.height=n.product1.insectHeight();if(e.settings.insect.height>2400){e.vm.controls.showProduct2(true);if(e.settings.insect.height==3200){n.product1.insectHeight(1600);n.product2.insectHeight(1600)}else{if(e.settings.insect.height==3600){n.product1.insectHeight(1600);n.product2.insectHeight(2000)}else{if(e.settings.insect.height==4000){n.product1.insectHeight(2000);n.product2.insectHeight(2000)}else{if(e.settings.insect.height==4400){n.product1.insectHeight(2000);n.product2.insectHeight(2400)}else{if(e.settings.insect.height==4800){n.product1.insectHeight(2400);n.product2.insectHeight(2400)}}}}}e.settings.onSelectInsectNet(n.product1.insectWidth()+" "+n.product1.insectHeight()+" "+n.product2.insectHeight())}else{if(e.settings.insect.shape()=="bent"){if(n.product2.insectHeight()==""){return false}e.settings.onSelectInsectNet(n.product1.insectWidth()+" "+n.product1.insectHeight())}else{n.product2.insectHeight("");e.vm.controls.showAddon(false);e.vm.controls.showProduct2(false);e.settings.onSelectInsectNet(n.product1.insectWidth()+" "+n.product1.insectHeight())}}},insectHeight2:function(){var o=e.vm.data,n=e.vm.config;if(e.settings.insect.shape()=="bent"){if(n.product1.insectHeight()==""){return false}e.settings.onSelectInsectNet(n.product1.insectWidth()+" "+n.product1.insectHeight()+" "+n.product2.insectHeight())}}}};try{c.each(generalSettings,function(n,o){if(typeof o!="object"){e.settings[n]=o}})}catch(j){}var i=new loadConfiguratorFunctions(e,b,a,c);var l=new loadRulesFunctions(e,i,b,a,c);var m=function(){var n=this};var d=function(){var n=this;n.buyProduct1=ko.observable(true);n.buyProduct2=ko.observable(true);n.buyProductAddon=ko.observable(true);n.showProduct2=ko.observable(false);n.showSelectionProducts=ko.observable(false);n.showCombination=ko.observable(false);n.showAddon=ko.observable(false);n.showQuestion=ko.observable(false);n.showShopButton=ko.observable(e.settings.showShopButton);n.showDealerButton=ko.observable(e.settings.showDealerButton);n.showPrintButton=ko.observable(e.settings.showPrintButton);n.showMailButton=ko.observable(e.settings.showMailButton);n.showCategoryStep=ko.observable(e.settings.showCategoryStep);n.updateConfigurator=function(p,o){e.vm.config.product1.productPrice("");e.vm.config.product2.productPrice("");e.vm.controls.buyProduct1(true);e.vm.controls.buyProduct2(true);e.dom.complete.find(".mmc__product .mmc__addToCart input:not(input:checked)").click();if(!e.dom.base.hasClass("mmc__loading")){e.trigger.target=c(o.target);e.trigger.type=e.trigger.target.attr("name")}i.hideMessage(0);if(e.change[e.trigger.type]()!=false){setTimeout(function(){e.update()},1)}};n.switchStep=function(){if(e.dom.activeStep().hasClass("mmc__filled")){var p=e.dom.activeStep().attr("data-type"),q=p.charAt(0).toUpperCase()+p.slice(1,p.length);try{e.settings["onNext"+q](q)}catch(o){}}i.switchStep()};n.showMessage=function(){i.showMessage()};n.stepIndex=function(o){var p=e.dom.options.find(".mmc__configStep."+o);targetIndex=p.index(".mmc__required")+1;return targetIndex}};var h=function(o){var n=this;n.windowtype=ko.observable("");n.windowsize=ko.observable("");n.windowTypeSize=ko.computed(function(){var q=(n.windowtype()==null)?"":n.windowtype(),p=(n.windowsize()==null)?"":n.windowsize();return q+" "+p});n.category=ko.observable("");n.operation=ko.observable("");n.finishtype=ko.observable("");n.colour=ko.observable("");n.outersurface=ko.observable("");n.insectWidth=ko.observable("");n.insectHeight=ko.observable("");n.configureType=ko.computed(function(){if(n.category()=="Shutters"){return"Shutter"}else{if(n.category()=="InsectNet"){return"InsectNet"}else{return"Blind"}}});n.variantcode=ko.observable("");n.productioncode=ko.observable("");c.each(e.options,function(p,q){n[q+"Text"]=ko.computed(function(){if(n[q]()){var r="";c.each(e.vm.data["product"+o][q](),function(s,t){var u=(e.vm.controls.showCombination()&&q=="category")?n[q]().match(/[A-Z][a-z]+/g)[o-1]:n[q]();if(t.val==u){r=t.name}});return r}})});n.insectWidthHeight=ko.computed(function(){var q=(n.insectWidthText()==null)?"":n.insectWidthText(),p=(n.insectHeightText()==null)?"":n.insectHeightText(),r=(n.insectWidthText()&&n.insectHeightText())?" / ":"";return q+r+p});n.productID=ko.observable("");n.serviceProductID=ko.observable("");n.productPrice=ko.observable("");n.formattedProductPrice=ko.computed(function(){var q=n.productPrice();try{if(e.vm.controls.showCombination()==true){if(o==2&&e.vm.config.product1.productPrice()){}else{return}}}catch(p){}return(q)?e.formatPrice(q):""});n.showProductRow=ko.observable("Blind");n.showFinishType=ko.observable(false);n.showCampaignText=ko.observable(false);n.showPrice=ko.observable(false);n.checkActive=function(q,p){return(n[q]()==p)?"mmc__active":""}};var k=function(){var n=this;n.VCE=ko.observable("");n.Name=ko.observable("");n.Desc=ko.observable("");n.ImageSrc=ko.observable("");n.Price=ko.observable("");n.Checked=ko.observable(false);n.productPrice=ko.observable("");n.serviceProductID=ko.observable("")};var g=function(){var n=this;n.windowtype=ko.observableArray([{val:null,name:e.settings.selectTypeText}]);n.windowsize=ko.observableArray([{val:null,name:e.settings.selectSizeText}]);n.category=ko.observableArray([]);n.operation=ko.observableArray([]);n.finishtype=ko.observableArray([]);n.colour=ko.observableArray([]);n.outersurface=ko.observableArray([]);n.insectWidth=ko.observableArray([{val:null,name:null}]);n.insectHeight=ko.observableArray([{val:null,name:null}])};e.vm={controls:new d(),config:{product1:new h(1),product2:new h(2)},addon:new k(),data:{product1:new g(),product2:new g()}};ko.applyBindings(e.vm);try{c.each(generalSettings,function(n,o){if(typeof o==="object"){if(n==="preConfig"){c.each(o,function(p,q){e.vm.config.product1[p.toLowerCase()](q)})}}});delete generalSettings}catch(j){}e.init();e.dom.title.bind("click",function(){var n=c(this).closest(".mmc__configStep");if((n.hasClass("mmc__filled")||n.hasClass("mmc__next"))&&!n.hasClass("mmc__active")&&(e.dom.activeStep().hasClass("mmc__filled")||(n.hasClass("mmc__filled")&&n.index()<e.dom.activeStep().index()))){i.switchStep(n)}});e.dom.title.find("a").bind("click",function(n){n.preventDefault()});e.dom.edit.bind("click",function(o){o.preventDefault();var n=e.dom.options.find(".mmc__configStep.mmc__"+c(this).attr("href").replace("#",""));i.switchStep(n)});e.dom.selection.on("click","img, .mmc__icon.mmc__zoom",function(){i.zoomIllustration(c(this).closest(".mmc__content").find(".mmc__window img"))});e.dom.selection.on("click",".mmc__icon.mmc__turn",function(){e.trigger.type="turn";i.updateIllustration()});e.dom.step.on({click:function(){return false},mouseenter:function(){e.trigger.target=c(event.target).closest(".mmc__option");e.trigger.type=e.trigger.target.attr("name");i.showInfoTooltip()},mouseleave:function(){i.hideInfoTooltip()}},".mmc__option.mmc__inactive");e.dom.step.on({click:function(q){if(c(q.target).closest(".mmc__option").hasClass("mmc__active")){return false}var p=c(q.target).closest(".mmc__option").find("input").val(),o=c(q.target).closest(".mmc__configStep").data("type"),n="product"+c(q.target).closest(".mmc__options").data("product");e.vm.config[n][o](p);if(c(q.target)[0].nodeName=="TD"){c(q.target).closest(".mmc__option").find("input").click()}c(q.target).closest(".mmc__option").find("input").change();return false},mouseover:function(n){if(c(n.target).closest(".mmc__tooltip").length>0||c(n.target).closest(".mmc__option").hasClass("mmc__finishtype")||c(n.target).closest(".mmc__option").hasClass("mmc__disableTooltip")){return}e.trigger.target=c(n.target).closest(".mmc__option").find("input");e.trigger.type=e.trigger.target.attr("name");i.showOptionTooltip()},mouseout:function(){i.hideOptionTooltip()}},".mmc__option:not(.mmc__option.mmc__inactive, .mmc__insectnet .mmc__option)");e.dom.base.on({mouseover:function(n){if(c(n.target).find("span.mmc__message").length==0&&c(n.target)[0].nodeName!="LABEL"||e.trigger.infotip){return}e.trigger.target=c(n.target);e.trigger.type=e.trigger.target.attr("name");i.showInfoTooltip()},mouseout:function(n){if(c(n.target).find("span.mmc__message").length==0&&c(n.target)[0].nodeName!="LABEL"){return}i.hideInfoTooltip()}},".mmc__icon, .mmc__select.mmc__disabled");e.dom.windows.on({mouseover:function(n){c(n.target).closest(".mmc__select").find("label").mouseover()},mouseleave:function(n){c(n.target).closest(".mmc__select").find("label").mouseleave()}},".mmc__select.mmc__disabled a, .mmc__select.mmc__disabled b, .mmc__select.mmc__disabled select");e.dom.insectSelect.on({click:function(n){n.preventDefault();c(this).closest(".mmc__insectNetTypes").find(".mmc__option").removeClass("mmc__active");c(this).closest(".mmc__option").addClass("mmc__active");c(this).closest(".mmc__configStep").removeClass("mmc__filled");e.dom.insect.find(".mmc__sizeRow.mmc__height2").hide();if(c(this).closest(".mmc__option").hasClass("mmc__bent")){e.dom.insect.find(".mmc__sizeRow.mmc__height2").show();e.vm.controls.showProduct2(true)}else{e.vm.controls.showProduct2(false)}e.dom.insect.find(".mmc__insectNetSizes").slideDown(500,"linear");if(e.vm.config.product1.insectWidth()!=""){e.dom.insect.find('select[name="insectWidth"]').change()}e.settings.onSelectInsectNetType(e.settings.insect.shape())}});c("body").on({submit:function(n){n.preventDefault();e.trigger.target=c(n.target).closest(".mmc__codeCheck");e.trigger.type=e.trigger.target.data("name");l.checkCode();return false}},".mmc__codeCheck form");c("body").on({click:function(n){c(n.target).closest(".mmc__codeCheck").find("form").submit()}},".mmc__codeCheck button");e.dom.base.on({click:function(){i.hideMessage()}},".mmc__userMessage .mmc__userMessageClose span");e.dom.complete.on({click:function(n){e.settings.onBeforeAddToBasket();e.settings.onButtonAddToBasket();e.trigger.target=c(n.target).closest(".mmc__button");e.trigger.type="gotobasket";var o=e.buildRequest();e.dom.complete.find("#mmc__AddToBasket input").attr("name","productsinfo").val(o);e.settings.onAfterAddToBasket();if(e.settings.shopTarget=="_blank"){setTimeout(function(){location.reload()},200)}else{if(e.settings.returnFunc!=null){e.settings.returnFunc(o);return false}else{e.update()}}}},".mmc__button button");e.dom.complete.on({change:function(p){e.trigger.target=c(p.target).closest(".mmc__product");e.trigger.type="productpurchase";var n=c(p.target).is(":checked"),o=e.trigger.target.index()+1;if(o>2){o="Addon"}e.vm.controls["buyProduct"+o](n)}},".mmc__addToCart.mmc__checkbox input");i.initShadowbox();e.dom.windows.on({click:function(o){var n=e.dom.blocks.windowtypesize[0].outerHTML;e.settings.onButtonWindowUnknown();Shadowbox.open({content:'<div class="mmc__infoPopup">'+n+'<div class="mmc__closePopup"><span class="mmc__text mmc__shadowBoxClose">'+e.settings.closeText+" x</span></div></div>",player:"html",width:884,options:{displayNav:false}});o.preventDefault()}},".mmc__options .mmc__button.mmc__small a");e.dom.complete.on({click:function(p){var n=c(p.target).closest(".mmc__userMessage").hasClass("mmc__variant")?"variant":"production",q=c(p.target).closest(".mmc__userMessage").data("rule"),o=e.dom.variant.find(".mmc__codeCheck.mmc__"+n)[0].outerHTML;Shadowbox.open({content:'<div class="mmc__infoPopup">'+o+'<div class="mmc__closePopup"><span class="mmc__text mmc__shadowBoxClose">'+e.settings.closeText+" x</span></div></div>",player:"html",width:884,options:{displayNav:false}})}},".mmc__userMessage.mmc__codeCheck");e.dom.complete.on({click:function(o){var n=e.dom.blocks.mailerPopup;e.trigger.target=c(this);if(c(".mmc__mailerPopup:visible").length>0){c(".mmc__mailerPopup").fadeOut(150);return false}c(".mmc__mailerPopup input").val("");c(".mmc__mailerPopup .mmc__sendingStatus").removeClass("mmc__sending mmc__success mmc__fail");n.css({top:e.trigger.target.offset().top+e.trigger.target.height()-e.dom.base.offset().top+5,left:e.trigger.target.offset().left-(n.outerWidth()/2)-e.dom.base.offset().left+5}).fadeIn(150);o.preventDefault()},mouseenter:function(){e.trigger.enter=function(){if(e.trigger.timeout!=null){clearTimeout(e.trigger.timeout);delete e.trigger.timeout}};e.trigger.enter()},mouseleave:function(){e.trigger.leave=function(){if(c(".mmc__mailerPopup:visible").length==0){return}e.trigger.timeout=setTimeout(function(){e.trigger.target.click();delete e.trigger.timeout;delete e.trigger.enter;delete e.trigger.leave},1000)};e.trigger.leave()}},".mmc__shareButtons .mmc__button.mmc__mail");e.dom.base.on({mouseenter:function(){e.trigger.enter()},mouseleave:function(){e.trigger.leave()}},".mmc__mailerPopup");e.dom.base.on({submit:function(n){e.settings.onButtonEmail();i.submitSendProductsByMail(n)}},".mmc__mailerPopup form");e.dom.complete.on({click:function(n){e.settings.onButtonPrint();b.print()}},".mmc__button.mmc__print a");e.dom.complete.on({click:function(n){e.settings.onButtonDealer()}},".mmc__button.mmc__dealer a")})})(window,document,jQuery);function loadConfiguratorFunctions(b,d,a,e){var c=this;this.initShadowbox=function(){Shadowbox.init({skipSetup:true,animateFade:false,displayNav:true,handleOversize:"none",enableKeys:false,onOpen:function(){e("div#sb-container div#sb-loading-inner span").text(e("div.mmc__siteSettings span.mmc__loadingText").text())},onFinish:function(){if(e("div.mmc__infoPopup").length>0){e("#sb-wrapper-inner").height(e("div.mmc__infoPopup").height()+80);if(e("div.mmc__infoPopup")[0].offsetHeight>e(d).height()){e("#sb-wrapper-inner").css({top:e(d).scrollTop()});e("body").addClass("sb-scrollable")}}e(".mmc__infoPopup").on({click:function(){Shadowbox.close()}},".mmc__shadowBoxClose")},onClose:function(){e("body").removeClass("sb-scrollable");e("#sb-wrapper-inner").removeAttr("style")}})};this.checkBrowser=function(f){if(navigator.userAgent.match(f,"gi")){return true}else{return false}};this.checkFilledSteps=function(f){var g=[];b.dom.step.removeClass("mmc__filled mmc__next");if(f.windowtype()&&f.windowsize()){g.push("windows")}if(f.category()){g.push("category")}if(f.operation()){g.push("operation")}if(f.outersurface()){g.push("outersurface")}if(f.colour()){g.push("colour")}if(f.finishtype()){g.push("finishtype")}if(f.variantcode()&&b.dom.variant.hasClass("mmc__required")&&b.dom.variant.find(".mmc__codeCheck").hasClass("mmc__check")){g.push("variant")}if(f.insectWidth()&&f.insectHeight()){g.push("insect")}e.each(g,function(h,i){b.dom[i].addClass("mmc__filled")});b.dom.options.find(".mmc__configStep.mmc__filled:last").nextAll(".mmc__required:first").addClass("mmc__next")};this.setStepIndex=function(){e.each(b.dom.options.find(".mmc__configStep.mmc__required"),function(f,g){e(g).find(".mmc__stepIndex td").text(f+1)})};this.checkObservableValue=function(l,k){var h=true;for(var g=0,f=l().length;g<f;g++){if(l()[g]["val"]==k){h=false;break}}return h};this.zoomIllustration=function(j){var s,n,m,i,r,l,q,k,o,f,p;s=j.attr("src");s=s.split("illustrations/");n=j.attr("alt");m='<img src="'+s[0]+"illustrations/large/"+s[1]+'" alt="'+n+'" />';function g(){l=j.offset().top;l-=e(d).scrollTop();i=j.offset().left;k=j.width()}function h(){g();e(".mmc__illustrationZoom img").animate({left:i,top:l,width:k,opacity:0},500);e(".mmc__illustrationZoom div.mmc__close").remove();e(".mmc__illustrationZoom div.mmc__background").animate({opacity:0},500,function(){e(".mmc__illustrationZoom").remove()})}e(m).load(function(){g();e("body").prepend('<div class="mmc__illustrationZoom"><div class="mmc__close"><div class="mmc__border mmc__left">&nbsp;</div><div class="mmc__border mmc__right">&nbsp;</div>X</div><div class="mmc__background">&nbsp;</div>'+m+"</div>");o=e(".mmc__illustrationZoom img").width();f=e(".mmc__illustrationZoom img").height();if(f>e(d).height()){p=((e(d).height()/f)-0.05);o=o*p;f=f*p}r=(e(d).width()/2)-(o/2);q=(e(d).height()/2)-(f/2);e(".mmc__illustrationZoom div.mmc__background").css({opacity:0});e(".mmc__illustrationZoom div.mmc__background").animate({opacity:0.7},500);e(".mmc__illustrationZoom img").css({left:i,top:l,width:k,opacity:0});e(".mmc__illustrationZoom img").animate({left:r,top:q,width:o,opacity:1},500,function(){e(".mmc__illustrationZoom div.mmc__close").css({left:r+o+e(".mmc__illustrationZoom div.mmc__border").outerWidth(),top:q})});e(".mmc__illustrationZoom div.mmc__close").bind("click",function(){h()})}).error(function(){})};this.updateIllustration=function(){if(b.settings.turning==true){return}var h=b.vm.config,i={},f,g;if(b.trigger.type=="turn"){b.settings.defaultImg=(b.settings.defaultImg=="product1")?"product2":"product1"}e.each(h,function(j,k){if(b.vm.controls.showCombination()==true){g=j.replace("product","")-1;if(b.trigger.type!="turn"){b.settings.defaultImg="product"+b.trigger.target.closest(".mmc__options").attr("data-product")}}i[j]={category:(b.vm.controls.showCombination()==true)?k.category().match(/[A-Z]*[^A-Z]+/g)[g]:k.category(),operation:k.operation(),colour:(k.category()=="Shutters")?k.outersurface():k.colour()}});f=c.getIllustrationURL(i[b.settings.defaultImg]);b.dom.selection.find(".mmc__window .mmc__newImg").append(f);c.swapIllustrations()};this.getIllustrationURL=function(i){var f=e("<img />"),g=[];if(!i.category){g.push("window")}else{if(i.category){g.push(i.category)}if(i.operation){g.push(i.operation)}if(i.colour){g.push(i.colour)}}function h(){f.attr("src",b.settings.ill.loc()+g.join("-")+".png").attr("alt",g.join(" ")).load().error(function(){if(i.colour){g.splice(1,1)}else{if(i.operation){g.splice(1,1)}}h(f)})}h();return f};this.swapIllustrations=function(){var h=b.dom.selection.find(".mmc__window"),f=h.find(".mmc__oldImg"),g=h.find(".mmc__newImg");b.settings.turning=true;f.find("img").fadeOut(500,function(){f.empty()});g.find("img").fadeIn(500,function(){e(this).appendTo(f);b.settings.turning=false})};this.switchStep=function(g){if(b.sliding==true){return false}b.settings.onBeforeSwitchStep();var h=b.dom.activeStep(),f=(g)?g:e(h.nextAll(".mmc__required")[0]);if(h.hasClass("mmc__filled")||(f.hasClass("mmc__filled")&&!h.hasClass("mmc__window"))){b.sliding=true;h.find(".mmc__content").slideUp(500,"linear",function(){e(this).closest(".mmc__configStep").removeClass("mmc__active");b.sliding=false});f.find(".mmc__content").slideDown(500,"linear",function(){e(this).closest(".mmc__configStep").addClass("mmc__active");b.settings.onAfterSwitchStep()});b.dom.selection.animate({marginTop:b.measure.stepHeight*f.index(".mmc__required")},500,"linear");if(h.find(".mmc__userMessage").length>0&&h.data("type")!="complete"){c.hideMessage()}if(f.hasClass("mmc__complete")){b.dom.selection.find(".mmc__product:not(.mmc__product.mmc__hidden)").slideUp(500,"linear",function(){b.vm.controls.showSelectionProducts(false)})}else{b.vm.controls.showSelectionProducts(true);if(b.dom.activeStep().hasClass("mmc__complete")){b.dom.selection.find(".mmc__product:not(.mmc__product.mmc__hidden)").hide()}b.dom.selection.find(".mmc__product:not(.mmc__product.mmc__hidden)").slideDown(500,"linear")}}else{c.showMessage()}};this.resetSteps=function(){var f=b.trigger.target.closest(".mmc__configStep").nextAll().not(".mmc__complete"),i=b.vm.data,g=b.vm.config,h;e.each(f,function(j,k){h=e(k).data("type");e.each(i,function(l,m){if(m[h]){m[h].removeAll()}if(h=="insectnet"){m.insectWidth.removeAll();m.insectHeight.removeAll()}});e.each(g,function(l,m){if(m[h]){m[h]("")}if(h=="insectnet"){m.insectWidth("");m.insectHeight("")}})});b.vm.controls.showQuestion(false)};this.selectWindowInput=function(){var f=b.vm.config.product1;if(!f.windowtype()&&!f.windowsize()){b.dom.windows.find("select#windowtype").trigger("chosen:updated")}else{if(f.windowtype()&&!f.windowsize()){c.hideInfoTooltip();b.dom.windows.find("select#windowtype").trigger("chosen:updated");b.dom.windows.find("select#windowsize").removeAttr("mmc__disabled").trigger("chosen:updated");b.dom.windows.find(".mmc__select.mmc__size a").mousedown()}else{if(f.windowtype()&&f.windowsize()){b.dom.windows.find("select#windowtype, select#windowsize").removeAttr("disabled").trigger("chosen:updated");b.dom.windows.find(".mmc__buttonBar .mmc__button a").focus()}}}};this.showMessage=function(k,h,g){var f=b.vm.config,i=b.dom.activeStep().data("type");if(b.dom.activeStep().find(".mmc__userMessage").length>0){c.hideMessage(0)}b.dom.activeStep().find(".mmc__content").append(b.dom.blocks.usermessage.clone());b.dom.message.base().addClass(h);b.dom.message.text().text("");b.dom.message.text().append("<ul></ul>");function j(l){b.dom.message.text().find("ul").append("<li>"+l+"</li>")}if(k!=undefined){j(k)}else{if(i=="window"){if(!f.product1.windowtype()){j(b.dom.windows.find("div.mmc__select.mmc__type label").text())}if(!f.product1.windowsize()){j(b.dom.windows.find("div.mmc__select.mmc__size label").text())}}else{k=b.dom.selection.find(".mmc__product:first .mmc__productRow.mmc__selection.mmc__"+i+" span.mmc__type").text().trim();if(k.charAt(k.length-1)==":"){k=k.slice(0,-1)}j(k)}}if(b.dom.activeStep().find(".mmc__content").offset().top<e(d).scrollTop()){offset=e(d).scrollTop();offset-=b.dom.activeStep().find(".mmc__content").offset().top;b.dom.message.base().css("marginTop",offset)}else{b.dom.message.base().css("marginTop","auto")}b.dom.message.base().fadeIn(200)};this.hideMessage=function(f){b.dom.base.find(".mmc__userMessage:not(.mmc__configStep.mmc__complete .mmc__userMessage)").fadeOut((f===undefined)?200:f,function(){e(this).remove()})};this.showOptionTooltip=function(){if(b.settings.tooltip.timeout){clearTimeout(b.settings.tooltip.timeout);b.settings.tooltip.timeout=null}if(b.settings.tooltip.open&&b.trigger.target.closest(".mmc__option").find(".mmc__tooltip").length>0){clearTimeout(b.settings.tooltip.open);b.settings.tooltip.open=null;return}b.settings.tooltip.timeout=setTimeout(function(){var f={category:"images/configurator/blindtype/",colour:"images/colours/large/",operation:"images/configurator/operation/",outersurface:"images/configurator/surface/",finishtype:"images/configurator/addon/"},g=(b.dom.activeStep().hasClass("mmc__operation"))?b.vm.config[b.trigger.target.closest(".mmc__options").attr("class").replace("mmc__options","").replace(" ","").replace("mmc__","")].category():"";if(b.vm.controls.showCombination()==true&&g){g=g.match(/[A-Z]*[^A-Z]+/g)[b.trigger.target.closest(".mmc__options").attr("data-product")-1]}b.trigger.target.closest(".mmc__option").append(b.dom.blocks.tooltip.clone());b.dom.tooltip=b.trigger.target.closest(".mmc__option").find(".mmc__tooltip");b.dom.tooltip.find(".mmc__tooltipImage img").attr("src",b.settings.directory+"content/"+f[b.trigger.type]+g+b.trigger.target.val()+".png");b.dom.tooltip.find(".mmc__tooltipDescription .mmc__tooltipTitle").html(b.trigger.target.closest(".mmc__option").find(".mmc__optionTitle").text());b.dom.tooltip.find(".mmc__tooltipDescription .mmc__tooltipInfo").html(b.trigger.target.closest(".mmc__option").find(".mmc__optionDesc").text());b.dom.tooltip.fadeIn((navigator.userAgent.match(/MSIE 7/gi)||navigator.userAgent.match(/MSIE 8/gi))?0:300);b.settings.tooltip.optionOffset=b.dom.tooltip.find(".mmc__tooltipImage").offset();b.settings.tooltip.tooltipWidth=b.dom.tooltip.find(".mmc__tooltipDescription").width();if(b.trigger.type=="colour"){b.settings.tooltip.tooltipWidth+=b.dom.tooltip.find(".mmc__tooltipImage").outerWidth()}b.settings.tooltip.optionRightOffset=b.settings.tooltip.optionOffset.left;b.settings.tooltip.optionRightOffset+=b.settings.tooltip.tooltipWidth;b.settings.tooltip.optionRightOffset+=5;b.settings.tooltip.optionTopOffset=b.settings.tooltip.optionOffset.top;b.settings.tooltip.optionTopOffset-=e(d).scrollTop();if(b.settings.tooltip.optionOffset.left<0){if(b.trigger.type=="colour"){b.dom.tooltip.offset({left:b.dom.tooltip.find(".mmc__tooltipImage").width()/2}).addClass("mmc__alignLeft")}else{b.dom.tooltip.offset({left:5})}}if(b.settings.tooltip.optionRightOffset>e(d).width()){if(b.trigger.type=="colour"){b.settings.tooltip.tooltipWidth-=(b.dom.tooltip.find(".mmc__tooltipImage").width()/2)-10}else{b.dom.tooltip.addClass("mmc__alignRight")}b.dom.tooltip.offset({left:(e(d).width()-b.settings.tooltip.tooltipWidth-5)})}if(b.dom.tooltip.hasClass("mmc__alignRight")){b.settings.tooltip.optionTopOffset-=(b.dom.tooltip.find(".mmc__tooltipImage").height()/2)+20}if(b.settings.tooltip.optionTopOffset<0){if(b.trigger.type=="colour"){if(b.dom.tooltip.hasClass("mmc__alignLeft")){b.settings.tooltip.optionTopOffset=b.dom.tooltip.offset().top+b.dom.tooltip.outerHeight()+164}else{b.settings.tooltip.optionTopOffset=b.dom.tooltip.offset().top+b.dom.tooltip.outerHeight()+100}b.dom.tooltip.offset({top:b.settings.tooltip.optionTopOffset})}else{b.dom.tooltip.addClass("mmc__alignBottom")}}b.settings.tooltip.timeout=null;b.settings.tooltip.open=true},400)};this.hideOptionTooltip=function(){if(b.settings.tooltip.timeout){clearTimeout(b.settings.tooltip.timeout);b.settings.tooltip.timeout=null}var f=b.trigger.target.closest(".mmc__option").find(".mmc__tooltip");b.settings.tooltip.open=setTimeout(function(){f.remove()},1)};this.showInfoTooltip=function(){var f=(b.trigger.target.css("marginLeft")=="auto")?"0":parseFloat(b.trigger.target.css("marginLeft"));b.dom.base.append(b.dom.blocks.infotip.clone());b.dom.infotip=b.dom.base.find(".mmc__infotip");b.settings.infotip.message=(b.trigger.target.find(".mmc__message").text()!="")?b.trigger.target.find(".mmc__message").text():b.settings.infotipMessage;b.dom.infotip.find(".mmc__infotipMessage").text(b.settings.infotip.message);b.dom.infotip.show().css({top:b.trigger.target.offset().top-(b.dom.infotip.height()+10)-b.dom.base.offset().top+10,left:b.trigger.target.offset().left+((b.trigger.target.width()-f-b.dom.infotip.find(".mmc__border").width()-b.dom.infotip.width())/2)-b.dom.base.offset().left+10});if(b.settings.infotip.offsetRight>e(d).width()){b.dom.infotip.addClass("mmc__right");b.dom.infotip.removeAttr("mmc__style")}else{if(b.settings.infotip.offsetLeft<0){b.dom.infotip.addClass("mmc__left");b.dom.infotip.removeAttr("mmc__style")}}};this.hideInfoTooltip=function(){if(b.dom.infotip!=null){b.dom.infotip.remove()}b.dom.infotip=null};this.clearCompleteStep=function(){b.vm.controls.showAddon(false);b.settings.rules.list={};e.each(b.settings.rules.variant,function(f,g){b.settings.rules.variant[f]=null});e.each(b.settings.rules.production,function(f,g){b.settings.rules.variant[f]=null});b.dom.complete.find(".mmc__product").removeClass("mmc__disabled");b.dom.complete.find(".mmc__userMessage").remove()};this.sendProductsByMail=function(l){l.preventDefault();var k={subject:b.dom.complete.find(".mmc__contentSubTitle").text(),title:b.dom.complete.find(".mmc__contentTitle").text(),subtitle:b.dom.complete.find(".mmc__contentSubTitle").text(),recipient:e(".mmc__mailerPopup input").val(),image:b.dom.selection.find(".mmc__window div.mmc__oldImg img").attr("src")},f=[],o=[],h=[],m=[],j=[],i,g=e(".mmc__mailerPopup .mmc__sendingStatus"),p=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;if(!p.test(k.recipient)){return false}b.trigger.type="sendmail";if(b.dom.complete.find(".mmc__userMessage:visible").length>0){e.each(b.dom.complete.find(".mmc__userMessage"),function(q,r){f.push('"'+e(r).data("rule")+'":"'+b.settings.rules.list[e(r).data("rule")].PostText+'"')});k.usermessages="{"+f.join(",")+"}"}e.each(b.dom.complete.find(".mmc__product:not(.mmc__product.mmc__addon)"),function(q,r){m=[];e.each(e(r).find(".mmc__productRow:visible"),function(t,s){i=e(s).attr("class").replace("mmc__productRow","").replace("mmc__ticked","").replace("mmc__selection","").trim();h=[];if(i=="placement"){h.push('"val":"'+e(s).find("span:visible").text()+'"')}else{if(i=="title"){h.push('"val":"'+(e(s).find("span.mmc__type").text()+" "+e(s).find("span.mmc__value").text()).trim()+'"')}else{if(i=="campaigntext"){}else{if(i=="price"){h.push('"from":"'+e(s).find("div.mmc__label").text()+'"');h.push('"price":"'+e(s).find("div.mmc__amount").text().replace(e(s).find("div.mmc__amount span.mmc__from").text(),"").trim()+'"')}else{if(e(s).hasClass("mmc__selection")){h.push('"title":"'+e(s).find("span.mmc__type").text()+'"');h.push('"val":"'+e(s).find("span.mmc__value").text()+'"')}}}}}m.push('"'+i+'":{'+h.join(",")+"}")});o.push('"'+q+'":{'+m.join(",")+"}")});k.products="{"+o.join(",")+"}";if(b.dom.complete.find(".mmc__product.mmc__addon:visible").length>0){var n=b.dom.complete.find(".mmc__product.mmc__addon");j.push('"product":"'+(n.find(".mmc__productRow.mmc__title span.mmc__type").text()+" "+n.find(".mmc__productRow.mmc__title span.mmc__value").text()).trim()+'"');j.push('"title":"'+n.find(".mmc__productName").text()+'"');j.push('"desc":"'+n.find(".mmc__productDesc").text()+'"');j.push('"priceLabel":"'+n.find(".mmc__productRow.mmc__price div.mmc__label").text()+'"');j.push('"price":"'+n.find(".mmc__productRow.mmc__price div.mmc__amount").text().replace(n.find(".mmc__productRow.mmc__price span.mmc__from").text(),"").trim()+'"');k.addon="{"+j.join(",")+"}"}g.addClass("mmc__sending");e.ajax({dataType:"jsonp",jsonpCallback:"jsonCallback",type:"GET",url:b.buildRequest(),data:k,beforeSend:function(q){q.setRequestHeader("Access-Control-Allow-Origin","*")},success:function(q){g.addClass("mmc__success").removeClass("mmc__sending")},error:function(q){g.addClass("mmc__fail").removeClass("mmc__sending")}})}}function configuratorLoaded(a){return true}function loadRulesFunctions(b,g,e,a,f){var c=this;this.process=function(h){if(b.settings.disableRules==true){return}f.each(h,function(i,k){b.settings.rules.variantUnknown=k.VariantUnknown;b.settings.rules.productionUnknown=k.ProductionUnknown;try{c["Rule"+i](k)}catch(j){c.RuleDefault(k)}});if(b.vm.controls.showQuestion()&&b.dom.complete.hasClass("mmc__active")){b.dom.complete.removeClass("mmc__active");b.dom.complete.find(".mmc__content").hide();b.dom.selection.find(".mmc__product:not(.mmc__hidden)").show();b.setActiveStep()}};var d={normal:{run:function(i){var h=["note"];c.showRuleMessage(i,i.PostText,h.join(" "))},range:["8","10","11","100","101","102","103","501"]},adapter:{run:function(i){var h=["note"];c.showAddonProduct(i);c.showRuleMessage(i,i.PostText,h.join(" "))},range:["503"]},insect:{run:function(i){var h=["note"];if(b.vm.controls.showProduct2()){c.showAddonProduct(i);c.showRuleMessage(i,i.PostText,h.join(" "))}},range:["504"]},rule505:{run:function(j){var i=["error"],h=b.vm.config.product1;if(h.windowsize().charAt(0)=="B"||h.windowsize().charAt(0)=="C"||h.windowsize().charAt(0)=="F"){c.showRuleMessage(j,j.PostText,i.join(" "))}},range:["505"]},rule506:{run:function(j){var i=["note"],h=b.vm.config.product1;if(h.windowsize().charAt(0)!="Y"){c.showRuleMessage(j,j.PostText,i.join(" "))}},range:["506"]},production:{run:function(i){var h=["note"];if(i.Product){if(i.Product.AskForProductCode){h.push("production");b.settings.rules.production.MatchFoundTrue=function(j){b.trigger.target.addClass("mmc__check");c.showRuleMessage(i,i.ProductionTrue,"check","tick");if(i.RuleNo=="9"){var k=b.dom.base.find('.mmc__product[data-productid*="MAD"]');k.removeClass("mmc__disabled")}};b.settings.rules.production.MatchFoundFalse=function(){b.trigger.target.addClass("mmc__error");c.showRuleMessage(i,i.ProductionFalse,"error","exclamation");if(i.RuleNo=="9"){var j=b.dom.base.find('.mmc__product[data-productid*="MAD"]');j.addClass("mmc__disabled");if(b.dom.complete.find(".mmc__products .mmc__product.mmc__disabled").length==b.dom.complete.find(".mmc__products .mmc__product").length){}}}}}c.showRuleMessage(i,i.PostText,h.join(" "))},range:["1","2","3","4","6","9"]},productionAddon:{run:function(i){var h=["note"];if(i.Product){if(i.Product.AskForProductCode){h.push("production");b.settings.rules.production.MatchFoundTrue=function(j){b.trigger.target.addClass("mmc__check");c.showRuleMessage(i,i.ProductionTrue,"check","tick");if(j!=""&&i.Addon){c.showAddonProduct(i)}else{c.hideAddonProduct(i)}};b.settings.rules.production.MatchFoundFalse=function(){b.trigger.target.addClass("mmc__error");c.showRuleMessage(i,i.ProductionFalse,"error","exclamation");if(i.Addon){c.hideAddonProduct(i)}}}}c.showRuleMessage(i,i.PostText,h.join(" "))},range:["5"]},variant:{run:function(i){var h=["note"];if(i.Product){if(i.Product.AskForTypeSignVariant){if(i.Variant==1){b.vm.controls.showQuestion(true);g.setStepIndex()}else{if(i.Variant==2){h.push("variant")}}if(!b.settings.rules.variant.MatchFoundTrue){b.settings.rules.variant.MatchFoundTrue=function(j){b.trigger.target.addClass("mmc__check");c.showRuleMessage(i,i.VariantTrue,"check","tick");if(i.RuleNo=="7"){var k=b.dom.base.find('.mmc__product[data-productid*="MAL"]');b.vm.controls.buyProduct2(true)}}}if(!b.settings.rules.variant.MatchFoundFalse){b.settings.rules.variant.MatchFoundFalse=function(){b.trigger.target.addClass("mmc__check");c.showRuleMessage(i,i.VariantFalse,"error","exclamation");if(i.RuleNo=="7"){var j=b.dom.base.find('.mmc__product[data-productid*="MAL"]');b.vm.controls.buyProduct2(false);if(b.dom.complete.find(".mmc__products .mmc__product.mmc__disabled").length==b.dom.complete.find(".mmc__products .mmc__product").length){}}}}}}c.showRuleMessage(i,i.PostText,h.join(" "))},range:["7","12","103"]},variantAddon:{run:function(i){var h=["note"];if(i.Variant==1){b.vm.controls.showQuestion(true);g.setStepIndex()}else{if(i.Variant==2){h.push("variant")}}b.settings.rules.variant.MatchFoundTrue=function(j){b.trigger.target.addClass("mmc__check");c.showRuleMessage(i,i.VariantTrue,"check","tick");b.dom.complete.find('.mmc__userMessage[data-rule="53"]').hide();b.dom.complete.find('.mmc__userMessage[data-rule="51"]').hide();if(j!=""){c.showAddonProduct(b.settings.rules.list[j]);if(j=="51"){b.dom.complete.find('.mmc__userMessage[data-rule="51"]').show()}else{b.dom.complete.find('.mmc__userMessage[data-rule="53"]').show()}}else{c.hideAddonProduct(i)}};b.settings.rules.variant.MatchFoundFalse=function(){b.trigger.target.addClass("mmc__error");c.showRuleMessage(i,i.VariantFalse,"error","exclamation");c.hideAddonProduct(i)};c.showRuleMessage(i,i.PostText,h.join(" "))},range:["51","53"]},customVariant:{run:function(i){var h=["note"];if(i.Variant==1){b.vm.controls.showQuestion(true);g.setStepIndex()}else{if(i.Variant==2){h.push("variant")}}if(!b.settings.rules.variant.MatchFoundTrue){b.settings.rules.variant.MatchFoundTrue=function(j){b.trigger.target.addClass("mmc__check");c.showRuleMessage(i,i.VariantTrue,"check","tick")}}if(!b.settings.rules.variant.MatchFoundFalse){b.settings.rules.variant.MatchFoundFalse=function(){b.trigger.target.addClass("mmc__error");c.showRuleMessage(i,i.VariantFalse,"error","exclamation")}}c.showRuleMessage(i,i.PostText,h.join(" "))},range:["50","601"]},customVariantAddon:{run:function(i){var h=["note"];if(i.Variant==1){b.vm.controls.showQuestion(true);g.setStepIndex()}else{if(i.Variant==2){h.push("variant")}}if(!b.settings.rules.variant.MatchFoundTrue){b.settings.rules.variant.MatchFoundTrue=function(j){b.trigger.target.addClass("mmc__check");c.showRuleMessage(i,i.VariantTrue,"check","tick");if(j!=""&&j==i.RuleNo){c.showAddonProduct(i)}else{c.hideAddonProduct(i)}}}if(!b.settings.rules.variant.MatchFoundFalse){b.settings.rules.variant.MatchFoundFalse=function(){b.trigger.target.addClass("mmc__error");c.showRuleMessage(i,i.VariantFalse,"error","exclamation");c.hideAddonProduct(i)}}c.showRuleMessage(i,i.PostText,h.join(" "))},range:["52","500","501","502"]}};f.each(d,function(h,i){f.each(i.range,function(j,k){c["Rule"+k]=d[h].run})});this.RuleDefault=function(h){d.normal.run(h)};this.showRuleMessage=function(m,l,k,j){var i=b.dom.blocks.usermessage.clone(),h=[];f.each(k.split(" "),function(n,o){h.push("mmc__"+o)});i.attr("data-rule",m.RuleNo);i.find(".mmc__userMessageTitle").remove();i.find(".mmc__userMessageClose").remove();i.find(".mmc__userMessageText").html(l);i.addClass(h.join(" "));if(k.match("variant")||k.match("production")){i.addClass("mmc__codeCheck")}if(f("#sb-container .mmc__infoPopup").length>0){i.appendTo(f("#sb-container .mmc__infoPopup .mmc__codeCheck")).show()}else{if(b.dom.activeStep().hasClass("mmc__variant")){i.prependTo(b.dom.activeStep().find(".mmc__content")).show()}else{i.insertBefore(b.dom.complete.find(".mmc__products")).show()}}if(m.Product){if(m.Product.AskForTypeSignVariant&&m.Variant==2){return}if(!m.Product.AskForTypeSignVariant&&!m.Variant){return}if(m.Product.AskForProductCode&&m.Production==1){return}if(m.RuleNo.charAt(0)==5&&m.RuleNo.length==3){return}}if(!m.Product){if(m.Variant==2){return}if(!m.Variant){return}}if(b.dom.activeStep().hasClass("mmc__variant")){return}i.hide()};this.showAddonProduct=function(l){var k=b.vm.addon,i=l.Addon,j=(!i.Price)?i.PriceWithVAT:(i.Price.HasDiscount)?i.Price.ProductPriceDiscounted.PriceWithVAT:i.Price.ProductPrice.PriceWithVAT,h=b.settings.percentDiscountAddon;if(i.ProductContent==null){b.vm.controls.showAddon(false);return}k.VCE(i.VCE);k.Name(i.ProductContent.name);k.Desc(i.ProductContent.desc_short);k.ImageSrc(b.settings.directory+"content/images/products/"+i.VCE.replace(" ","-").toLowerCase()+".jpg");k.Price(b.formatPrice(j));if(l.AddonChecked==1){k.Checked(true)}else{k.Checked(false)}if(h===undefined){h=b.settings.percentDiscount}if(h!=null){j=(parseFloat(j)*((100-h)/100)).toFixed(2)}k.productPrice(j);k.serviceProductID(i.ProductID);b.vm.controls.showAddon(true)};this.hideAddonProduct=function(h){b.vm.controls.showAddon(false)};this.checkCode=function(){var i=b.trigger.target.find("input").val().toUpperCase(),h=(b.trigger.target.closest(".mmc__codeCheck").hasClass("mmc__variant"))?"variant":"production";b.vm.config.product1[h+"code"](i);b.trigger.target.removeClass("mmc__error mmc__check");b.dom.variant.find(".mmc__userMessage").remove();f("#sb-container").find(".mmc__userMessage").remove();if(i==""){return}b.trigger.target.addClass("mmc__loading");f.ajax({dataType:"jsonp",jsonpCallback:"jsonCallback",type:"GET",url:b.buildRequest(),success:function(j){var k=j,l=b.settings.rules;b.dom.complete.find(".mmc__userMessage.mmc__matchfound").hide().removeClass("mmc__matchfound");if(k.UnknownVariant||k.UnknownProductionCode){b.trigger.target.addClass("mmc__error");c.showRuleMessage("",l[h+"Unknown"],"error","exclamation")}else{if(k.MatchFound==true){l[h].MatchFoundTrue(k.MatchCompatibility.RuleNo);if(b.dom.activeStep().hasClass("mmc__variant")){if(k.MatchCompatibility.RuleNo&&k.MatchCompatibility.RuleNo!="103"){b.dom.complete.find('.mmc__userMessage[data-rule="'+k.MatchCompatibility.RuleNo+'"]').show().addClass("mmc__matchfound")}else{if(k.MatchCompatibility.RuleNo=="103"){b.dom.complete.find('.mmc__userMessage[data-rule="'+k.MatchCompatibility.RuleNo+'"]').hide()}else{b.dom.complete.find(".mmc__userMessage.matchfound:not(.mmc__userMessage.mmc__codeCheck)").hide().removeClass("mmc__matchfound")}}}}else{if(k.MatchFound==false){l[h].MatchFoundFalse();if(b.dom.activeStep().hasClass("mmc__variant")){}}}}b.trigger.target.removeClass("mmc__loading");g.checkFilledSteps(b.vm.config.product1)},error:function(j){}})}};